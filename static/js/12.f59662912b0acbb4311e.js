(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{210:function(t,e,s){},236:function(t,e,s){"use strict";var a=s(210);s.n(a).a},262:function(t,e,s){"use strict";s.r(e);var a=s(8),i=s.n(a),n=s(74),l=s.n(n),o=s(9),r=s(2),c=s(23),u=s(1),m=s(101),g=s(31),d=s(32);o.default.use(r.InfiniteScroll),o.default.component(r.Navbar.name,r.Navbar),o.default.component(r.TabItem.name,r.TabItem);var h={components:{noData:m.a},data:function(){return{mSelected:"message",loading:!0,messageList:[],todoList:[],messageBadgeNum:0,backlogBadgeNum:0,numList:[],sum:0,noMessageTip:"",noTodoTip:"",pageNum:1,limit:10,isBacklog:!1,loginStatus:null,cutHeight:0}},watch:{mSelected:function(t){this.isBacklog="backlog"==t}},computed:{},mounted:function(){this.msgMainPt(),window.addEventListener("resize",this.msgMainPt)},created:function(){this.msign=!1,this.numList=[],this.messageList=[],this.pageNum=1,this.sum=0,this.loginStatus=u.a.getItem(u.a.USER_LOGIN_STATUS),console.log("this.loginStatus",this.loginStatus),u.a.getItem("user.login.info")?this.userinfo=u.a.getItem("user.login.info"):Object(g.a)(this),this.loginStatus&&(this.getMyMsg(),this.getMyTodo()),this.$route.query.selected&&(this.mSelected=this.$route.query.selected)},methods:{msgMainPt:function(){this.cutHeight=this.$refs.mtNavbar.$el.clientHeight,this.$refs.msgMain.style.paddingTop=this.cutHeight+"px";var t=window.innerHeight-document.getElementsByClassName("entry-footer")[0].clientHeight-this.cutHeight+"px";console.log("c",t),document.querySelectorAll(".message-main .mint-tab-container-item")[0].style.cssText="height:"+t,document.querySelectorAll(".message-main .mint-tab-container-item")[1].style.cssText="height:"+t},getMyMsg:function(){var r=this;Object(c.a)({that:this,method:"getMyMsg",paramObj:{limit:this.limit,pageNum:this.pageNum},callback:function(t){if(0==t.data.total)r.noMessageTip="暂无消息";else{r.loading=!1,r.messageList=r.messageList.concat(t.data.msgs);var e=!0,s=!1,a=void 0;try{for(var i,n=l()(r.messageList);!(e=(i=n.next()).done);e=!0){var o=i.value;o.status=o.isRead}}catch(t){s=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(s)throw a}}}console.log("this.messageList.length",r.messageList.length),console.log("res.data.total",t.data.total),r.messageList.length>=t.data.total&&(r.loading=!0),r.msign||(r.messageBadgeNum=t.data.unReadNum,r.sumBadge(r.messageBadgeNum),r.msign=!0)}})},getMyTodo:function(){var r=this;console.log(2),Object(c.a)({that:this,method:"getMyTodo",paramObj:{},callback:function(t){if(0==t.data.todos.length)r.noTodoTip="暂无待办任务";else{r.todoList=t.data.todos;var e=!0,s=!1,a=void 0;try{for(var i,n=l()(r.todoList);!(e=(i=n.next()).done);e=!0){var o=i.value;o.status=o.isProcess}}catch(t){s=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(s)throw a}}}r.backlogBadgeNum=t.data.unProcessNum,r.sumBadge(r.backlogBadgeNum)}})},sumBadge:function(t){this.sum+=t,this.numList.push(t),1<this.numList.length&&this.$store.dispatch("SetBadgeNum",this.sum)},loadMore:function(){this.isBacklog||(this.pageNum++,this.getMyMsg())},toApprove:function(t){if(0==Object(d.a)(this.userinfo.nsr)){var e=this.userinfo.nsr.yhsfdm;if("01"!=e&&"02"!=e)return void Object(r.Toast)("您无此权限")}"bssf"==t.type?this.$router.push("/entry/company/taxerIdApprove"):"dlba"==t.type&&this.$router.push({path:"/entry/company/agencyApproveD",query:{dlbasqid:t.id}})},toArticle:function(t){this.$router.push({path:"/entry/article",query:{data:i()(t)}})},toLogin:function(){this.$router.push({path:"/login",query:{redirect_url:this.$route.fullPath}})}},destroyed:function(){window.removeEventListener("resize",this.msgMainPt)}},p=(s(236),s(0)),f=Object(p.a)(h,function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{ref:"msgMain",staticClass:"message-main"},[a("mt-navbar",{ref:"mtNavbar",staticStyle:{position:"fixed",top:"0",width:"100%","z-index":"99"},model:{value:s.mSelected,callback:function(t){s.mSelected=t},expression:"mSelected"}},[a("mt-tab-item",{attrs:{id:"message"}},[s._v("\n      消息\n      "),a("span",{directives:[{name:"show",rawName:"v-show",value:0<s.messageBadgeNum,expression:"messageBadgeNum>0"}],staticClass:"badge"},[s._v(s._s(s.messageBadgeNum))])]),s._v(" "),a("mt-tab-item",{attrs:{id:"backlog"}},[s._v("\n      预警\n      "),a("span",{directives:[{name:"show",rawName:"v-show",value:0<s.backlogBadgeNum,expression:"backlogBadgeNum>0"}],staticClass:"badge"},[s._v(s._s(s.backlogBadgeNum))])])],1),s._v(" "),a("mt-tab-container",{model:{value:s.mSelected,callback:function(t){s.mSelected=t},expression:"mSelected"}},[a("mt-tab-container-item",{attrs:{id:"message"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:s.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},s._l(s.messageList,function(e,t){return a("message-card",{key:t,attrs:{data:e},nativeOn:{click:function(t){return s.toArticle(e)}}})}),1),s._v(" "),0==s.messageList.length&&s.noMessageTip?a("div",{staticClass:"no-tip"},[a("no-data",{attrs:{cutFooter:"",unit:"px",cutHeight:s.cutHeight,tip:s.noMessageTip}})],1):s._e()]),s._v(" "),a("mt-tab-container-item",{attrs:{id:"backlog"}},[a("div",s._l(s.todoList,function(e,t){return a("message-card",{key:t,attrs:{todo:"",data:e},nativeOn:{click:function(t){return s.toApprove(e)}}})}),1),s._v(" "),0==s.messageList.length&&s.noTodoTip?a("div",{staticClass:"no-tip"},[a("no-data",{attrs:{cutFooter:"",unit:"px",cutHeight:s.cutHeight,tip:s.noTodoTip}})],1):s._e()])],1)],1)},[],!1,null,"5515a36e",null);e.default=f.exports}}]);